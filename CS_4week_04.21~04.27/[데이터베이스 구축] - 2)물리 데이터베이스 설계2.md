# [데이터베이스 구축] - 2)물리 데이터베이스 설계2







## 7. 파티션 설계

+ 파티션은 대용량의 테이블이나 인덱스를 **작은 논리적 단위인 파티션으로 나누는 것**을 말한다.
  + 대용량 DB의 경우 중요한 몇 개의 테이블에만 집중되어 데이터가 증가되므로, 이런 테이블들을 작은 단위로 나눠 분산시키면 성능 저하를 방지할 뿐만 아니라 데이터 관리도 쉬워진다.
  + 테이블이나 인덱스를 파티셔닝하면 **파티션키 또는 인덱스키에 따라 물리적으로 별도의 공간에 데이터가 저장된다.**
  + **데이터 처리는 테이블 단위**로 이뤄지고, **데이터 저장은 파티션별**로 수행된다.
    + 즉, 애플리케이션은 파티션을 인식하지 못함. 데이터 처리는 테이블 단위

### 7.1 파티션의 장단점

+ 장점
  + 데이터 접근 시 액세스 범위를 줄여 쿼리 성능 향상
  + 분산 저장으로 디스크 성능 향상
  + 파티션별로 백업 및 복구를 수행하므로 속도가 빠름
  + 시스템 장애 시 데이터 손상 정도를 최소화
  + 파티션 단위로 데이터 입출력 분산
+ 단점
  + 하나의 테이블을 세분화하여 관리하므로 세심한 관리가 요구됨
  + **테이블간 조인에 대한 비용 증가**
  + **용량이 작은 데이터라면 오히려 파티셔닝이 성능 저하**





### 7.2 파티션의 종류

+ 파티션의 종류는 파티셔닝 방식에 따라 범위 분할, 해시 분할, 조합 분할 등으로 나뉜다.
+ **범위 분할**
  + 지정한 열의 값을 기준으로 분할
+ **해시 분할**
  + 해시 함수를 적용한 결과 값에 따라 데이터를 분할
+ **조합 분할**
  + 범위 분할로 분할한 다음 해시 함수를 적용하여 다시 분할하는 방식







## 8. 분산 데이터베이스 설계(중요)

+ 분산 DB는 **논리적으로는 하나의 시스템**에 속하지만 **물리적으로는 네트워크를 통해 연결된 여러 개의 컴퓨터 사이트에 분산**되어 있는 DB를 말한다.

+ 데이터의 처리나 이용이 많은 지역에 DB를 위치시킴으로써 데이터의 처리가 가능한 해당 지역에서 해결될 수 있도록 한다.

### 8.1 분산 DB 구성 요소

+ **분산 처리기**
  + **자체적으로 처리 능력**을 가지며, **지리적으로 분산되어 있는 컴퓨터 시스템**
+ **분산 DB**
  + **지리적으로 분산되어 있는 DB**로서 해당 지역의 특성에 맞게 DB가 구성됨
+ **통신 네트워크**
  + **분산 처리기들을 통신망으로 연결**하여 **논리적으로 하나의 시스템처럼** 작동할 수 있도록 하는 역할





### 8.2 분산 DB 설계 시 고려 사항

+ 작업부하의 노드별 분산 정책
+ **지역의 자치성 보장** 정책
+ **데이터의 일관성** 정책
+ 통신 네트워크를 통한 **원격 접근 가능**





### 8.3 분산 DB의 목표(중요)

+ **위치 투명성**
  + 액세스하려는 DB의 실제 위치를 알 필요 없이 단지 **DB의 논리적인 명칭만으로 액세스 가능**
+ **중복 투명성**
  + **동일 데이터가 여러 곳에 중복되어 있더라도 사용자는 마치 하나의 데이터만 존재하는 것처럼 사용**하고 시스템은 자동으로 여러 자료에 대한 작업을 수행
+ **병행 투명성**
  + 분산 DB와 관련된 **다수의 트랜잭션들이 동시에 실현되더라도 그 트랜잭션의 결과는 영향을 받지 않는다.**

+ **장애 투명성**
  + 트랜잭션, DBMS, 네트워크, 컴퓨터 **장애에도 불구하고 트랜잭션을 정확하게 처리**한다.





### 8.4 분산 DB의 장단점

+ 장점
  + 지역 자치성이 높다.
  + 자료의 공유성이 향상된다.
  + 분산 제어가 가능하다.
  + **시스템 성능이 향상된다.**
  + **중앙 컴퓨터의 장애가 전체 시스템에 영향을 끼치지 않는다.**
+ 단점
  + DBMS가 수행할 기능이 복잡하다.
  + DB설계가 어렵다.
  + 처리 비용이 증가한다.
  + 잠재적 오류가 증가한다.





### 8.5 테이블 위치 분산

+ 테이블 위치 분산은 **DB의 테이블을 각기 다른 서버에 분산시켜 배치**하는 방법이다.
+ 테이블 위치를 분산할 때는 테이블의 구조를 변경하지 않으며, 다른 DB의 테이블과 중복되지 않게 배치
+ DB의 테이블을 각각 다른 위치에 배치하려면 해당 테이블들이 놓일 서버들을 미리 설정해야 한다.





### 8.6 분할

+ 테이블의 데이터를 분할하여 분산시키는 것
+ 분할 규칙
  + **완전성**
    + **전체 데이터를 대상**으로 분할해야 한다.
  + **재구성**
    + 분할된 데이터는 관계 연산을 활용하여 **본래의 데이터로 재구성할 수 있어야 한다.**
  + **상호 중첩 배제**
    + 분할된 데이터는 **서로 다른 분할의 항목에 속하지 않아야 한다.**
+ 주요 분할 방법
  + **수평 분할**
    + 특정 **속성의 값을 기준**으로 행 단위로 분할
  + **수직 분할**
    + 데이터 **컬럼 단위**로 분할





### 8.7 할당

+ 할당은 **동일한 분할을 여러 개의 서버에 생성하는 분산 방법**으로, 중복이 없는 할당과 중복이 있는 할당으로 나뉜다.

+ **비중복 할당 방식**
  + **최적의 노드를 선택**해서 **분산 DB의 단일 노드에서만 분할이 존재하도록 하는 방식**
+ **중복 할당 방식**
  + **동일한 테이블을 다른 서버에 복제하는 방식**







## 9. DB 이중화 / 서버 클러스터링

+ **DB 이중화**는 시스템 오류로 인한 DB 서비스 중단이나 물리적 손상 발생 시 **이를 복구하기 위해 동일한 DB를 복제하여 관리하는 것**

  + 분류
    + **Eager 기법**
      + **트랜잭션 수행 중** 데이터 변경의 발생하면 **이중화된 모든 DB에 즉시 전달하여 변경 내용이 즉시 적용**되도록 하는 기법
    + **Lazy 기법**
      + **트랜잭션의 수행이 종료되면 변경 사실을 새로운 트랜잭션에 작성**하여 각 DB에 전달한은 기법으로, **DB마다 새로운 트랜잭션이 수행되는 것으로 간주**

  + 구성 방법

    + **활동-대기 방법**

      + 한 DB가 활성 상태면 한 DB는 대기하고 있다가 **활성 DB에 장애가 발생하면 대기 DB가 자동으로 모든 서비스를 대신 수행**

    + **활동-활동 방법**

      + **두 개의 DB가 서로 다른 서비스를 제공하다가 한 쪽에 장애가 생기면 다른 쪽이 모든 서비스를 수행**

      

+ **클러스터링**은 **두 대 이상의 서버를 하나의 서버처럼 운영**하는 기술
  + 서버 이중화 및 공유 스토리지를 사용하여 서버의 고가용성을 제공







## 10. 데이어베이스 보안 / 암호화

+ DB 보안이란 DB의 일부분 또는 전체에 대해서 **권한이 없는 사용자가 액세스하는 것을 금지**
+ DB사용자들은 일반적으로 서로 다른 객체에 대하여 다른 접근 권리 또는 권한을 갖게 된다.



+ **암호화**
  + 암호화는 **데이터를 보낼 때 송신자가 지정한 수신자 외에는 그 내용을 알 수 없도록 평문을 암호문으로 변환**하는 것
  + 암호화 과정 / 복호화 과정
  + 개인키 암호 방식(비밀키 암호 방식)
    + 비밀키 암호화 기법은 **동일한 키로 데이터를 암호화하고 복호화**한다.
    + **대칭 암호 방식** 또는 **단일키 암호화 기법**이라고도 한다.
    + 비밀키는 제3자에게는 노출시키지 않고 DB 사용 권한이 있는 사용자만 나누어 가진다.
  + 공개키 암호 방식
    + 서로 다른 키로 데이터를 암호화하고 복호화한다.
    + 데이터를 암호화할 때 사용하는 키(공개키)는 DB 사용자에게 공개하고, 복호화할 때의 키(비밀키)는 관리자가 비밀리에 관리하는 방법







## 11. 데이터베이스 보안 - 접근통제(Access Control)

+ 접근통제는 **데이터가 저장된 객체와 이를 사용하려는 주체 사이의 정보 흐름을 제한**하는 것이다.
+ 다음과 같은 통제들을 함
  + 비인가된 사용자의 접근 감시
  + 접근 요구자의 사용자 식별
  + 접근 요구의 정당성 확인 및 기록
  + 보안 정책에 근거한 접근의 승인 및 거부 등
+ 접근통제 기술에는 임의 접근통제, 강제 접근통제, 역할기반 접근통제가 있다.

  + **임의 접근통제(DAC)**
    + 데이터에 접근하는 사용자의 신원에 따라 접근 권한을 부여
    + **데이터 소유자가 접근통제 권한을 지정하고 제어**
    + SQL문으로는 REVOKE와 GRANT

  + **강제 접근통제(MAC)**
    + 주체와 객체의 등급을 비교하여 접근 권한을 부여
    + 시스템이 접근통제 권한을 지정
    + **DB 객체 별로 보안 등급을 부여, 사용자별로 인가 등급을 부여**
  + **역할기반 접근통제(RBAC)**
    + 역할기반 접근통제는 **사용자의 역할에 따라 접근 권한을 부여**하는 방식
    + **중앙관리자가 접근 통제 권한을 지정**
    + 임의 접근통제와 강제 접근통제의 단점을 보완, 다중 프로그래밍에 적합
    + 중앙관리자가 역할마다 권한을 부여

+ 접근통제의 3요소는 **접근통제 정책**, **접근통제 메커니즘**, **접근통제 보안모델**

### 11.1 접근통제 정책

+ 접근통제 정책은 어떤 주체가 언제, 어디서, 어떤 객체에게, 어떤 행위에 대한 허용 여부를 정의하는 것으로 신분 기반 정책, 규칙 기반 정책, 역할 기반 정책이 있다.





### 11.2 접근통제 매커니즘

+ 정의된 접근통제 정책을 구현하는 기술적인 방법으로, **접근통제 목록, 능력 리스트, 보안 등급, 패스워드, 암호화** 등이 있다.
  + 접근통제 목록
    + 객를 기준으로 특정 객체에 어떤 주체가 어떤 행위를 할 수 있는지를 기록한 목록
  + 능력 리스트
    + 주체를 기준으로 주체에게 허가된 자원 및 권한을 기록한 목록
  + 보안 등급
    + 주체나 객체 등에 부여된 보안 속성의 집합





### 11.3 접근통제 보안 모델

+ 정책을 구현하기 위한 정형화된 모델로, **기밀성 모델, 무결성 모델, 접근통제 모델**이 있다.
+ **기밀성 모델**
  + 군사적인 목적으로 개발된 최초의 수학적 모델로, 기밀성 보장이 최우성인 모델
+ **무결성 모델**
  + 불법적인 정보 변경을 방지하기 위해 무결성을 기반으로 개발된 모델
+ **접근통제 모델**
  + 접근통제 매커니즘을 보안 모델로 발전시킨 것으로, 접근통제 행렬이 대표적이다.
  + 접근통제 행렬
    + 행은 주체, 열은 객체 즉, 행과 열로 주체와 객체의 권한 유형을 나타낸다.
    + 교차점에는 규칙을 적으며, CRUD형태의 규칙을 적는다.





### 11.4 접근통제 조건

+ 접근통제 매커니즘의 취약점을 보완하기 위해 접근통제 정책에 부가하여 적용할 수 있는 조건
+ **값 종속 통제**
  + 객체에 저장된 값에 따라 다르게 접근통제를 해야하는 경우
+ **다중 사용자 통제**
  + 지정된 객체에 다수의 사용자가 동시에 접근을 요구하는 경우
+ **컨텍스트 기반 통제**
  + 특정 시간, 네트워크 주소, 접근 경로, 인증 수즌 등에 근거하여 접근을 제어하는 방법
    + ex) 근무시간 09:00 ~ 18:00 사이에만 접근 가능